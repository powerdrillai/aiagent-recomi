(function(t){typeof define=="function"&&define.amd?define(t):t()})(function(){"use strict";var E=Object.defineProperty;var f=(t,o,r)=>o in t?E(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r;var c=(t,o,r)=>f(t,typeof o!="symbol"?o+"":o,r);var t=(e=>(e.INITIALIZED="initialized",e.NOT_INITIALIZED="not-initialized",e))(t||{}),o=(e=>(e.RECOMI_SDK_INITIALIZED="RecomiSdkInitialized",e))(o||{});const s=class s{constructor(){c(this,"isInitialized",!1);c(this,"showApp",!1);c(this,"recomiAppIframeId");c(this,"SECRET_KEY")}static getInstance(){return s.instance||(s.instance=new s),s.instance}init(i){if(console.log("TODO 执行init"),this.isInitialized){console.warn("SDK already initialized");return}this.SECRET_KEY=i,this.isInitialized=!0}getState(){return console.log("getState"),this.isInitialized?t.INITIALIZED:t.NOT_INITIALIZED}bindIframe(i){this.recomiAppIframeId=i,this.changeAppVisiblity();const n=window.frames.RecomiAppIframe_RECOMI;n.onload=()=>{const a=n.contentWindow,m={message:o.RECOMI_SDK_INITIALIZED,config:{SECRET_KEY:this.SECRET_KEY}};if(a){console.log(a,this.SECRET_KEY);const d="https://aiagent-recomi-app.vercel.app/";console.log(d),a==null||a.postMessage(m,d)}}}changeAppVisiblity(){if(this.showApp=!this.showApp,console.log(this.showApp,this.recomiAppIframeId),this.recomiAppIframeId){const i=document.getElementById(this.recomiAppIframeId);if(i)this.showApp?i.style.visibility="visible":i.style.visibility="hidden";else{console.warn("unexpected unexisted ");return}}else console.warn("lack of recomiAppIframeId")}};c(s,"instance");let r=s;function l(){const e=document.createElement("iframe");e.src="https://aiagent-recomi-app.vercel.app/",e.id="RecomiAppIframe_RECOMI",Object.assign(e.style,{width:"400px",height:"600px",position:"fixed",bottom:"82px",right:"16px",border:"1px solid #e5e7eb",borderRadius:"8px",background:"white",zIndex:"9999"}),document.body.appendChild(e),window.recomi?window.recomi.bindIframe("RecomiAppIframe_RECOMI"):console.error("Recomi is not initialized.")}const p=e=>{var i;!window.recomi||window.recomi.getState()!==t.INITIALIZED?(window.recomi=new r,window.recomi.init(e),l()):(console.log("Already initialized"),(i=window==null?void 0:window.recomi)==null||i.changeAppVisiblity())};function I(e){const i={width:"3.5rem",height:"3.5rem",backgroundColor:"black",color:"white",borderRadius:"9999px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",transition:"background-color 0.2s",position:"fixed",bottom:"10px",right:"16px",zIndex:"9999"},n=Object.assign(document.createElement("button"),{type:"button",ariaLabel:"Open chat"});return Object.assign(n.style,i),n.innerHTML=`
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
      <path stroke-linecap="round" stroke-linejoin="round" d="M12 20.25c4.97 0 9-3.694 9-8.25s-4.03-8.25-9-8.25S3 7.444 3 12c0 2.104.859 4.023 2.273 5.48.432.447.74 1.04.586 1.641a4.483 4.483 0 01-.923 1.785A5.969 5.969 0 006 21c1.282 0 2.47-.402 3.445-1.087.81.22 1.668.337 2.555.337z"/>
    </svg>
  `,n.addEventListener("click",()=>p(e)),document.body.appendChild(n),n}console.log({BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_RECOMIAPP_IFRAMEID:"RecomiAppIframe_RECOMI",VITE_RECOMI_ORIGIN:"https://aiagent-recomi-app.vercel.app/"}),typeof window<"u"&&function(){const e=document.currentScript;console.log(e),console.log(e==null?void 0:e.getAttribute("SECRET_KEY")),console.log(e==null?void 0:e.getAttribute("domain"));function i(){const n=document.createElement("div");n.id="recomi-root",document.body.appendChild(n),I((e==null?void 0:e.getAttribute("SECRET_KEY"))||"")}i()}()});
//# sourceMappingURL=RecomiSDK.umd.cjs.map
